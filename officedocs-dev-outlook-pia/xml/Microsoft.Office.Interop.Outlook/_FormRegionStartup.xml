<Type Name="_FormRegionStartup" FullName="Microsoft.Office.Interop.Outlook._FormRegionStartup">
  <Metadata><Meta Name="ms.openlocfilehash" Value="b34bd4c4bdf22fffb31f02727f5872c4371b275f" /><Meta Name="ms.sourcegitcommit" Value="372abf58b21f4fab503d106f0e8c8a2ac45f9332" /><Meta Name="ms.translationtype" Value="MT" /><Meta Name="ms.contentlocale" Value="zh-CN" /><Meta Name="ms.lasthandoff" Value="01/12/2019" /><Meta Name="ms.locfileid" Value="27904579" /></Metadata><TypeSignature Language="C#" Value="public interface _FormRegionStartup" />
  <TypeSignature Language="ILAsm" Value=".class public interface auto ansi abstract _FormRegionStartup" />
  <TypeSignature Language="DocId" Value="T:Microsoft.Office.Interop.Outlook._FormRegionStartup" />
  <TypeSignature Language="VB.NET" Value="Public Interface _FormRegionStartup" />
  <TypeSignature Language="C++ CLI" Value="public interface class _FormRegionStartup" />
  <AssemblyInfo>
    <AssemblyName>Microsoft.Office.Interop.Outlook</AssemblyName>
    <AssemblyVersion>15.0.0.0</AssemblyVersion>
  </AssemblyInfo>
  <Interfaces />
  <Attributes>
    <Attribute>
      <AttributeName>System.Runtime.InteropServices.Guid("00063059-0000-0000-C000-000000000046")</AttributeName>
    </Attribute>
    <Attribute>
      <AttributeName>System.Runtime.InteropServices.TypeLibType(4160)</AttributeName>
    </Attribute>
  </Attributes>
  <Docs>
    <summary><span data-ttu-id="6fb67-101">这是与相应的 COM 对象的互操作性的托管代码需要 COM coclass 中的主接口。</span><span class="sxs-lookup"><span data-stu-id="6fb67-101">This is a primary interface in a COM coclass that is required by managed code for interoperability with the corresponding COM object.</span></span> <span data-ttu-id="6fb67-102">仅当您想要使用的方法共享相同的名称的 COM 对象; 事件时，才使用此主接口在这种情况下，强制转换为此接口调用方法，并强制转换为最新的事件接口，连接到该事件。</span><span class="sxs-lookup"><span data-stu-id="6fb67-102">Use this primary interface only when the method you want to use shares the same name as an event of the COM object; in this case, cast to this interface to call the method, and cast to the latest events interface to connect to the event.</span></span> <span data-ttu-id="6fb67-103">否则，使用.NET 接口派生自 COM coclass 访问方法、 属性和事件的 COM 对象。</span><span class="sxs-lookup"><span data-stu-id="6fb67-103">Otherwise, use the .NET interface that is derived from the COM coclass to access methods, properties, and events of the COM object.</span></span> <span data-ttu-id="6fb67-104">有关 COM 对象的信息，请参阅<see cref="T:Microsoft.Office.Interop.Outlook.FormRegionStartup" />。</span><span class="sxs-lookup"><span data-stu-id="6fb67-104">For information about the COM object, see <see cref="T:Microsoft.Office.Interop.Outlook.FormRegionStartup" />.</span></span></summary>
    <remarks>To be added.</remarks>
  </Docs>
  <Members>
    <Member MemberName="BeforeFormRegionShow">
      <MemberSignature Language="C#" Value="public void BeforeFormRegionShow (Microsoft.Office.Interop.Outlook.FormRegion FormRegion);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig newslot virtual instance void BeforeFormRegionShow([in]class Microsoft.Office.Interop.Outlook.FormRegion FormRegion) runtime managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.Office.Interop.Outlook._FormRegionStartup.BeforeFormRegionShow(Microsoft.Office.Interop.Outlook.FormRegion)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void BeforeFormRegionShow(Microsoft::Office::Interop::Outlook::FormRegion ^ FormRegion);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.Office.Interop.Outlook</AssemblyName>
        <AssemblyVersion>15.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.Runtime.InteropServices.DispId(64317)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="FormRegion" Type="Microsoft.Office.Interop.Outlook.FormRegion" />
      </Parameters>
      <Docs>
        <param name="FormRegion"><span data-ttu-id="6fb67-105">表示要显示的窗体区域的 <b>FormRegion</b> 对象。</span><span class="sxs-lookup"><span data-stu-id="6fb67-105">The <b>FormRegion</b> object representing the form region that is to be displayed.</span></span></param>
        <summary><span data-ttu-id="6fb67-106">允许加载项在显示窗体区域之前先更新窗体区域的用户界面。</span><span class="sxs-lookup"><span data-stu-id="6fb67-106">Allows an add-in to update the user interface of a form region before it is displayed.</span></span></summary>
        <remarks><para><span data-ttu-id="6fb67-p102">此方法允许 Outlook 将 <b>FormRegion</b> 对象传递到加载项，并允许外接程序以更新该窗体区域的用户界面，因此，例如，可以更改标签文本或者禁止显示不相关的内容显示它之前。后实例化控件和计算的布局，但之前该窗体区域将出现，并调用它。</span><span class="sxs-lookup"><span data-stu-id="6fb67-p102">This method lets Outlook pass the <b>FormRegion</b> object to the add-in, and allows an add-in to update the user interface of the form region before it is displayed so that, for instance, the text of labels can be changed or irrelevant content can be suppressed. It is called after the controls are instantiated and the layout is calculated, but before the form region is made visible. </span></span></para>
          <para><span data-ttu-id="6fb67-109">实现此方法时，请记住，从获取的项目<paramref name="FormRegion" />参数 (即， <see cref="P:Microsoft.Office.Interop.Outlook._FormRegion.Item" /> ， <b>FormRegion</b>对象的属性) 是只读的。</span><span class="sxs-lookup"><span data-stu-id="6fb67-109">When implementing this method, keep in mind that the item obtained from the <paramref name="FormRegion" /> parameter (that is, the <see cref="P:Microsoft.Office.Interop.Outlook._FormRegion.Item" /> property of the <b>FormRegion</b> object) is read-only.</span></span></para>
          <para><span data-ttu-id="6fb67-110">有关加载项 C# 和 Visual Basic.NET 中实现<b>FormRegionStartup</b>的示例，请参阅 MSDN 上的代码示例下载。</span><span class="sxs-lookup"><span data-stu-id="6fb67-110">For examples of add-ins in C# and  Visual Basic .NET that implement <b>FormRegionStartup</b>, see code sample downloads on MSDN.</span></span></para>
          <para> </para></remarks>
      </Docs>
    </Member>
    <Member MemberName="GetFormRegionIcon">
      <MemberSignature Language="C#" Value="public object GetFormRegionIcon (string FormRegionName, int LCID, Microsoft.Office.Interop.Outlook.OlFormRegionIcon Icon);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig newslot virtual instance object GetFormRegionIcon([in]string FormRegionName, [in]int32 LCID, [in]valuetype Microsoft.Office.Interop.Outlook.OlFormRegionIcon Icon) runtime managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.Office.Interop.Outlook._FormRegionStartup.GetFormRegionIcon(System.String,System.Int32,Microsoft.Office.Interop.Outlook.OlFormRegionIcon)" />
      <MemberSignature Language="VB.NET" Value="Public Function GetFormRegionIcon (FormRegionName As String, LCID As Integer, Icon As OlFormRegionIcon) As Object" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Object ^ GetFormRegionIcon(System::String ^ FormRegionName, int LCID, Microsoft::Office::Interop::Outlook::OlFormRegionIcon Icon);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.Office.Interop.Outlook</AssemblyName>
        <AssemblyVersion>15.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.Runtime.InteropServices.DispId(64564)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Object</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="FormRegionName" Type="System.String" />
        <Parameter Name="LCID" Type="System.Int32" />
        <Parameter Name="Icon" Type="Microsoft.Office.Interop.Outlook.OlFormRegionIcon" />
      </Parameters>
      <Docs>
        <param name="FormRegionName"><span data-ttu-id="6fb67-111">在 Windows 注册表中注册窗体区域时使用的窗体区域的名称。</span><span class="sxs-lookup"><span data-stu-id="6fb67-111">The name of the form region which is the name used when registering the form region in the Windows registry.</span></span></param>
        <param name="LCID"><span data-ttu-id="6fb67-p103">标识 Outlook 当前使用的语言的区域设置 ID。此值用于获取与窗体区域的此语言相对应的本地化字符串。</span><span class="sxs-lookup"><span data-stu-id="6fb67-p103">The locale ID  that identifies the language that  Outlook is currently  using. This value is used to obtain the localization strings corresponding to this language for the form region.</span></span></param>
        <param name="Icon"><span data-ttu-id="6fb67-114">一个标识图标类型的常量。</span><span class="sxs-lookup"><span data-stu-id="6fb67-114">A constant that identifies the type of icon.</span></span></param>
        <summary><span data-ttu-id="6fb67-115">获取一个将为窗体区域的特定类型图标显示的图标图像。</span><span class="sxs-lookup"><span data-stu-id="6fb67-115">Obtains an icon image that will be displayed for a particular type of icon for the form region.</span></span></summary>
        <returns><span data-ttu-id="6fb67-116">一个<b>对象</b>，它代表图像文件的原始字节的字节数组或一个<b>IPictureDisp</b>对象。</span><span class="sxs-lookup"><span data-stu-id="6fb67-116">An <b>Object</b> that is either a byte-array that represents the original bytes of the image file or an <b>IPictureDisp</b> object.</span></span></returns>
        <remarks><para><span data-ttu-id="6fb67-117">此方法应由加载项实现并由 Outlook 调用。</span><span class="sxs-lookup"><span data-stu-id="6fb67-117">This method is intended to be implemented by an add-in and called by Outlook.</span></span> <span data-ttu-id="6fb67-118">一部分<see cref="T:Microsoft.Office.Interop.Outlook.FormRegionStartup" />接口，此方法和<see cref="M:Microsoft.Office.Interop.Outlook._FormRegionStartup.GetFormRegionManifest(System.String,System.Int32)" />方法提供一种机制，通过该外接程序可以注册窗体区域并提供 Outlook 的 XML 指令清单的图标与窗体区域。</span><span class="sxs-lookup"><span data-stu-id="6fb67-118">As part of the <see cref="T:Microsoft.Office.Interop.Outlook.FormRegionStartup" /> interface, this method and the <see cref="M:Microsoft.Office.Interop.Outlook._FormRegionStartup.GetFormRegionManifest(System.String,System.Int32)" /> method provide a mechanism through which an add-in can register a form region and provide Outlook with the XML manifest and the icons for the form region.</span></span></para>
          <para><span data-ttu-id="6fb67-119">如果您将外接程序来为窗体区域提供的图标，请指定的外接程序的 ProgID，当您在 Windows 注册表中注册窗体区域。</span><span class="sxs-lookup"><span data-stu-id="6fb67-119">If you would like an add-in to provide icons for a form region, specify the ProgID of the add-in when you register the form region in the Windows registry.</span></span> <span data-ttu-id="6fb67-120">有关注册窗体区域的详细信息，请参阅<a href="http://go.microsoft.com/fwlink/?LinkId=87933">在 Windows 注册表中指定窗体区域</a><b>GetFormRegionManifest</b>和<b>FormRegionStartup</b>接口的<b>GetFormRegionIcon</b>方法。</span><span class="sxs-lookup"><span data-stu-id="6fb67-120">For more information on registering a form region, see <a href="http://go.microsoft.com/fwlink/?LinkId=87933">Specifying Form Regions in the Windows Registry</a><b>GetFormRegionManifest</b> and the <b>GetFormRegionIcon</b> methods of the  <b>FormRegionStartup</b> interface.</span></span> </para>
          <para><span data-ttu-id="6fb67-121">在 XML 清单中的窗体区域，在 icons 元素，指定您想要使用自定义图标的子元素的每个的值外接程序。</span><span class="sxs-lookup"><span data-stu-id="6fb67-121">In the XML manifest for the form region, under the icons element, specify the value addin for each of the child elements where you would like to use a custom icon.</span></span>  <span data-ttu-id="6fb67-122">实现<b>GetFormRegionIcon</b> ，以便当 Outlook 作为参数传入的图标的类型<paramref name="Icon" />， <b>GetFormRegionIcon</b>返回的自定义图标的图像。</span><span class="sxs-lookup"><span data-stu-id="6fb67-122">Implement <b>GetFormRegionIcon</b> such that when Outlook passes that type of icon as an argument for <paramref name="Icon" />,  <b>GetFormRegionIcon</b> returns the image of the custom icon.</span></span> <span data-ttu-id="6fb67-123">如果您希望 Outlook 显示的默认图标，实现<b>GetFormRegionIcon</b> ，以便返回<b>Nothing</b> （中的空引用 (在 Visual Basic 中为 Nothing) C#） 图标的类型。</span><span class="sxs-lookup"><span data-stu-id="6fb67-123">If you want Outlook to display the default icon, implement <b>GetFormRegionIcon</b> such that it returns <b>Nothing</b> (a null reference (Nothing in Visual Basic) in C#) for that type of icon.</span></span> <span data-ttu-id="6fb67-124"><b>GetFormRegionIcon</b>还应时返回<b>Nothing</b> （中的空引用 (在 Visual Basic 中为 Nothing) C#）<paramref name="Icon" />是<b>olFormRegionIconDefault</b>。</span><span class="sxs-lookup"><span data-stu-id="6fb67-124"><b>GetFormRegionIcon</b> should also return <b>Nothing</b> (a null reference (Nothing in Visual Basic) in C#) when <paramref name="Icon" /> is <b>olFormRegionIconDefault</b>.</span></span></para>
          <para> <span data-ttu-id="6fb67-p107">当 Outlook 启动时，它从 Windows 注册表中读取窗体区域列表，并将与窗体区域相关联的数据存储在缓存中。如果窗体区域已经注册了 ProgID ，则对于 XML 清单中 icons 元素的子元素的值为 addin 的任何图标，Outlook 将通过调用其 <b>GetFormRegionIcon</b> 实现来使用相应的加载项。请注意，如果没有在 Windows 注册表中指定任何 ProgID，则 Outlook 不会调用 <b>GetFormRegionManifest</b> 和 <b>GetFormRegionIcon</b> 方法。</span><span class="sxs-lookup"><span data-stu-id="6fb67-p107">When Outlook starts, it reads the list of form regions from the Windows registry and caches the data associated with the form regions. If a form region has been registered with a ProgID, Outlook will resort to the corresponding add-in by calling its implementation of <b>GetFormRegionIcon</b> for any icon in the XML manifest that has addin as the value of a child element of the icons element. Note that if you do not specify any ProgID in the Windows registry, Outlook will not call the  <b>GetFormRegionManifest</b> and <b>GetFormRegionIcon</b> methods.</span></span></para>
          <para> </para></remarks>
      </Docs>
    </Member>
    <Member MemberName="GetFormRegionManifest">
      <MemberSignature Language="C#" Value="public object GetFormRegionManifest (string FormRegionName, int LCID);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig newslot virtual instance object GetFormRegionManifest([in]string FormRegionName, [in]int32 LCID) runtime managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.Office.Interop.Outlook._FormRegionStartup.GetFormRegionManifest(System.String,System.Int32)" />
      <MemberSignature Language="VB.NET" Value="Public Function GetFormRegionManifest (FormRegionName As String, LCID As Integer) As Object" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Object ^ GetFormRegionManifest(System::String ^ FormRegionName, int LCID);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.Office.Interop.Outlook</AssemblyName>
        <AssemblyVersion>15.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.Runtime.InteropServices.DispId(64563)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Object</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="FormRegionName" Type="System.String" />
        <Parameter Name="LCID" Type="System.Int32" />
      </Parameters>
      <Docs>
        <param name="FormRegionName"><span data-ttu-id="6fb67-128">在 Windows 注册表中注册窗体区域时使用的窗体区域的名称。</span><span class="sxs-lookup"><span data-stu-id="6fb67-128">The name of the form region which is the name used when registering the form region in the Windows registry.</span></span></param>
        <param name="LCID"><span data-ttu-id="6fb67-p108">标识 Outlook 当前使用的语言的区域设置 ID。此值用于获取与窗体区域的此语言相对应的本地化字符串。</span><span class="sxs-lookup"><span data-stu-id="6fb67-p108">The locale ID  that identifies the language that  Outlook is currently  using. This value is used to obtain the localization strings corresponding to this language for the form region.</span></span></param>
        <summary><span data-ttu-id="6fb67-131">获取窗体区域的 XML 清单。</span><span class="sxs-lookup"><span data-stu-id="6fb67-131">Obtains the XML manifest for a form region.</span></span></summary>
        <returns><span data-ttu-id="6fb67-132">一个<b>对象</b>，表示窗体区域的 XML 清单。</span><span class="sxs-lookup"><span data-stu-id="6fb67-132">An <b>Object</b> that represents the XML manifest for a form region.</span></span> <span data-ttu-id="6fb67-133">此 XML 字符串包含窗体区域，如 （按照指定的 title 元素） 的显示名称、 任何相关的布局文件或加载项、 任何受支持的用户操作和任何本地化字符串的特征。</span><span class="sxs-lookup"><span data-stu-id="6fb67-133">This XML string includes characteristics of the form region such as the display name (as specified by the title element), any associated layout file or add-in,  any supported user actions, and any localization strings.</span></span> <span data-ttu-id="6fb67-134">XML 必须按照窗体区域 XML 架构。</span><span class="sxs-lookup"><span data-stu-id="6fb67-134">The XML must follow the form region XML schema.</span></span> <span data-ttu-id="6fb67-135">窗体区域 XML 架构的详细信息，请参阅<a href="http://msdn.microsoft.com/en-us/library/default.aspx">MSDN 库</a>中 Microsoft Outlook 2010 XML 架构参考</span><span class="sxs-lookup"><span data-stu-id="6fb67-135">For more information on the form region XML schema, see the Microsoft Outlook 2010 XML Schema Reference in the <a href="http://msdn.microsoft.com/en-us/library/default.aspx">MSDN Library</a></span></span></returns>
        <remarks><para><span data-ttu-id="6fb67-136">此方法应由加载项实现并由 Outlook 调用。</span><span class="sxs-lookup"><span data-stu-id="6fb67-136">This method is intended to be implemented by an add-in and called by Outlook.</span></span> <span data-ttu-id="6fb67-137">一部分<see cref="T:Microsoft.Office.Interop.Outlook.FormRegionStartup" />接口，此方法和<see cref="M:Microsoft.Office.Interop.Outlook._FormRegionStartup.GetFormRegionIcon(System.String,System.Int32,Microsoft.Office.Interop.Outlook.OlFormRegionIcon)" />方法提供一种机制，通过该外接程序可以注册窗体区域并提供 Outlook 的 XML 指令清单和图标窗体区域。</span><span class="sxs-lookup"><span data-stu-id="6fb67-137">As part of the <see cref="T:Microsoft.Office.Interop.Outlook.FormRegionStartup" /> interface, this method and the <see cref="M:Microsoft.Office.Interop.Outlook._FormRegionStartup.GetFormRegionIcon(System.String,System.Int32,Microsoft.Office.Interop.Outlook.OlFormRegionIcon)" /> method provide a mechanism through which an add-in can register a form region and provide Outlook the XML manifest and the icons for the form region.</span></span></para>
          <para><span data-ttu-id="6fb67-138">如果您希望外接程序提供一个窗体区域 XML 清单，指定 ProgID的外接程序，当您在 Windows 注册表中注册窗体区域。</span><span class="sxs-lookup"><span data-stu-id="6fb67-138">If you would like an add-in to provide the XML manifest for a form region, specify the ProgID of the add-in when you register the form region in the Windows registry.</span></span> <span data-ttu-id="6fb67-139">有关注册窗体区域的详细信息，请参阅<a href="http://go.microsoft.com/fwlink/?LinkId=87933">在 Windows 注册表中指定窗体区域</a><b>GetFormRegionManifest</b>方法<b>FormRegionStartup</b>接口。</span><span class="sxs-lookup"><span data-stu-id="6fb67-139">For more information on registering a form region, see <a href="http://go.microsoft.com/fwlink/?LinkId=87933">Specifying Form Regions in the Windows Registry</a><b>GetFormRegionManifest</b> method of the  <b>FormRegionStartup</b> interface.</span></span> <span data-ttu-id="6fb67-140">请注意，是否您在 Windows 注册表中未指定任何 ProgID ，Outlook 将不会调用此方法。</span><span class="sxs-lookup"><span data-stu-id="6fb67-140">Note that if you do not specify any ProgID in the Windows registry, Outlook will not call this method.</span></span></para>
          <para><span data-ttu-id="6fb67-141">依靠外接程序提供一个窗体区域的 XML 清单也意味着您允许外接程序为该窗体区域提供的任何图标。</span><span class="sxs-lookup"><span data-stu-id="6fb67-141">Relying on an add-in to provide the XML manifest for a form region also means you are allowing the add-in to provide any icons for the form region.</span></span> <span data-ttu-id="6fb67-142">外接程序必须实现 <b>FormRegionStartup</b> 接口 <b>GetFormRegionIcon</b> 。</span><span class="sxs-lookup"><span data-stu-id="6fb67-142">The add-in must also implement the <b>GetFormRegionIcon</b> of the <b>FormRegionStartup</b> interface.</span></span> <span data-ttu-id="6fb67-143">Outlook 将调用 <b>GetFormRegionIcon</b> 来获取任何外接程序中指定的图标的窗体区域。</span><span class="sxs-lookup"><span data-stu-id="6fb67-143">Outlook will call <b>GetFormRegionIcon</b> to obtain any add-in specified icons for the form region.</span></span> <span data-ttu-id="6fb67-144">使用外接程序来指定图标的详细信息，请参阅<a href="http://go.microsoft.com/fwlink/?LinkId=87934">如何： 使用窗体区域加载到指定的图标</a></span><span class="sxs-lookup"><span data-stu-id="6fb67-144">For more information on using an add-in to specify icons, see <a href="http://go.microsoft.com/fwlink/?LinkId=87934">How to: Use an Add-in to Specify Icons for a Form Region</a></span></span></para>
          <para> <span data-ttu-id="6fb67-145">当 Outlook 启动时，它会从 Windows 注册表中读取列表中的窗体区域并缓存的数据。</span><span class="sxs-lookup"><span data-stu-id="6fb67-145">When Outlook starts, it reads the list of form regions from the Windows registry and caches the data.</span></span> <span data-ttu-id="6fb67-146">根据此数据，如果 Outlook 通知的外接程序已指定要为窗体区域中提供的 XML 指令清单，Outlook 将使用缓存的数据中提供的 ProgID，并调用由获取此加载项实现<b>GetFormRegionManifest</b>方法需要显示窗体区域的 XML。</span><span class="sxs-lookup"><span data-stu-id="6fb67-146">Based on this data, if  Outlook notices that an add-in has been specified to provide the XML manifest for a form region, Outlook will use the ProgID provided in the cached data and call the <b>GetFormRegionManifest</b> method implemented by this add-in to obtain the XML it needs to display the form region.</span></span> <span data-ttu-id="6fb67-147">如果 XML 清单无效并且不符合窗体区域 XML 架构，Outlook 将不能加载窗体区域。</span><span class="sxs-lookup"><span data-stu-id="6fb67-147">If the XML manifest is not valid and does not conform to the form region XML schema, Outlook will not be able to load the form region.</span></span> <span data-ttu-id="6fb67-148">此外，如果您没有在 Windows 注册表中指定任何 ProgID，Outlook 将不会调用<b>GetFormRegionManifest</b>和<b>GetFormRegionIcon</b>方法。</span><span class="sxs-lookup"><span data-stu-id="6fb67-148">Also, if you do not specify any ProgID in the Windows registry, Outlook will not call the  <b>GetFormRegionManifest</b> and <b>GetFormRegionIcon</b> methods.</span></span></para>
          <para><span data-ttu-id="6fb67-149">当加载项提供 XML 清单时，Outlook 会忽略以下元素：</span><span class="sxs-lookup"><span data-stu-id="6fb67-149">Outlook ignores the following elements when the add-in provides the XML manifest:</span></span> </para>
          <list type="bullet">
            <item>
              <para><span data-ttu-id="6fb67-150">名称： Outlook 忽略为此元素指定的值，将使用在注册表中为窗体区域指定的名称。</span><span class="sxs-lookup"><span data-stu-id="6fb67-150">name: Outlook ignores the value specified for this element and will  use the name  specified for the form region in the registry.</span></span></para>
            </item>
            <item>
              <para><span data-ttu-id="6fb67-151">layoutFile ：由于加载项会扩展此窗体区域，因此 Outlook 将忽略此元素。</span><span class="sxs-lookup"><span data-stu-id="6fb67-151">layoutFile: Outlook ignores this element because an add-in is extending this form region.</span></span></para>
            </item>
            <item>
              <para><span data-ttu-id="6fb67-152">addin：Outlook 使用注册表中前面带有等号 (=) 的值作为加载项的 ProgID。</span><span class="sxs-lookup"><span data-stu-id="6fb67-152">addin: Outlook uses the value that is preceded by an equal sign (=) in the registry as the ProgID of the add-in.</span></span></para>
            </item>
            <item>
              <para><span data-ttu-id="6fb67-153">stringOverride 的 文件 属性: Outlook 忽略 stringOverride 元素所指定的任何辅助本地化文件。</span><span class="sxs-lookup"><span data-stu-id="6fb67-153">file attribute of stringOverride: Outlook ignores any secondary localization file specified by the stringOverride element.</span></span> <span data-ttu-id="6fb67-154">外接程序可以实现<b>GetFormRegionManifest</b>返回为指定的字符串本地化的 XML 清单的内嵌<paramref name="LCID" />，或管理本地化字符串中的另一种方法，例如，使用.NET Framework 本地化，然后返回指定相应的 XML 指令清单<paramref name="LCID" />。</span><span class="sxs-lookup"><span data-stu-id="6fb67-154">The add-in can implement <b>GetFormRegionManifest</b> to return inline the XML manifest for string localization for the specified <paramref name="LCID" />, or manage  string localization in another way, for example, using .NET Framework localization, and then return the appropriate XML manifest for the specified <paramref name="LCID" />.</span></span></para>
            </item>
          </list>
          <para> </para></remarks>
      </Docs>
    </Member>
    <Member MemberName="GetFormRegionStorage">
      <MemberSignature Language="C#" Value="public object GetFormRegionStorage (string FormRegionName, object Item, int LCID, Microsoft.Office.Interop.Outlook.OlFormRegionMode FormRegionMode, Microsoft.Office.Interop.Outlook.OlFormRegionSize FormRegionSize);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig newslot virtual instance object GetFormRegionStorage([in]string FormRegionName, [in]object Item, [in]int32 LCID, [in]valuetype Microsoft.Office.Interop.Outlook.OlFormRegionMode FormRegionMode, [in]valuetype Microsoft.Office.Interop.Outlook.OlFormRegionSize FormRegionSize) runtime managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.Office.Interop.Outlook._FormRegionStartup.GetFormRegionStorage(System.String,System.Object,System.Int32,Microsoft.Office.Interop.Outlook.OlFormRegionMode,Microsoft.Office.Interop.Outlook.OlFormRegionSize)" />
      <MemberSignature Language="VB.NET" Value="Public Function GetFormRegionStorage (FormRegionName As String, Item As Object, LCID As Integer, FormRegionMode As OlFormRegionMode, FormRegionSize As OlFormRegionSize) As Object" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Object ^ GetFormRegionStorage(System::String ^ FormRegionName, System::Object ^ Item, int LCID, Microsoft::Office::Interop::Outlook::OlFormRegionMode FormRegionMode, Microsoft::Office::Interop::Outlook::OlFormRegionSize FormRegionSize);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.Office.Interop.Outlook</AssemblyName>
        <AssemblyVersion>15.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.Runtime.InteropServices.DispId(64310)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Object</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="FormRegionName" Type="System.String" />
        <Parameter Name="Item" Type="System.Object" />
        <Parameter Name="LCID" Type="System.Int32" />
        <Parameter Name="FormRegionMode" Type="Microsoft.Office.Interop.Outlook.OlFormRegionMode" />
        <Parameter Name="FormRegionSize" Type="Microsoft.Office.Interop.Outlook.OlFormRegionSize" />
      </Parameters>
      <Docs>
        <param name="FormRegionName"><span data-ttu-id="6fb67-155">窗体区域的内部名称。</span><span class="sxs-lookup"><span data-stu-id="6fb67-155">The internal name of the form region.</span></span> <span data-ttu-id="6fb67-156">这可以由&lt;名称&gt;相应窗体区域 XML 清单中的标记。</span><span class="sxs-lookup"><span data-stu-id="6fb67-156">This can be indicated by the &lt;name&gt; tag in the corresponding form region XML manifest.</span></span></param>
        <param name="Item"><span data-ttu-id="6fb67-157">导致加载窗体区域的 Outlook 项目对象。</span><span class="sxs-lookup"><span data-stu-id="6fb67-157">The Outlook item object that caused the loading of the form region.</span></span></param>
        <param name="LCID"><span data-ttu-id="6fb67-158">当前的区域设置 ID。</span><span class="sxs-lookup"><span data-stu-id="6fb67-158">The current locale ID.</span></span></param>
        <param name="FormRegionMode"><span data-ttu-id="6fb67-159">要将窗体区域加载到的模式。</span><span class="sxs-lookup"><span data-stu-id="6fb67-159">The mode that  the form region is being loaded into.</span></span></param>
        <param name="FormRegionSize"><span data-ttu-id="6fb67-160">所加载的窗体区域的类型（相邻或独立）。</span><span class="sxs-lookup"><span data-stu-id="6fb67-160">The type of form region being loaded, either adjoining or separate.</span></span></param>
        <summary><span data-ttu-id="6fb67-161">基于指定的信息获取窗体区域的相应存储。</span><span class="sxs-lookup"><span data-stu-id="6fb67-161">Obtains appropriate storage for a form region based on the specified information.</span></span></summary>
        <returns><span data-ttu-id="6fb67-162">代表 Outlook 窗体区域已分配的存储<b>对象</b>。</span><span class="sxs-lookup"><span data-stu-id="6fb67-162">A <b>Object</b> representing the storage that Outlook has allocated for the form region.</span></span> <span data-ttu-id="6fb67-163">可以是返回值类型： <b>String</b> （C# 中的<b>字符串</b>） 表示的返回值 Outlook 窗体存储的本地路径 (。OFS) 文件;<b>Byte （)</b>表示的返回值是一个包含的内容的字节数组。OFS 文件;<b>IStorage</b>表示的返回值是 COM 存储对象 （适用于 c + + 仅）; <b>IStorage</b><b>Nothing</b>或<b>空</b>，表示 Outlook 无法为此窗体区域分配存储，并将不会加载窗体区域。</span><span class="sxs-lookup"><span data-stu-id="6fb67-163">The type of the return value can be: <b>String</b> (<b>string</b> in C#) representing that the return value is a local path to an Outlook Form Storage (.OFS) file; <b>Byte()</b> representing that the return value is an array of bytes that contains the contents of the .OFS file; <b>IStorage</b> representing that the return value is a COM storage object <b>IStorage</b> (for C++ only); <b>Nothing</b> or <b>Null</b>, representing that Outlook could not allocate storage for this form region and will not load the form region.</span></span></returns>
        <remarks><para><span data-ttu-id="6fb67-p117">外接程序必须检查 <b>GetFormRegionStorage</b> 的返回值。如果下列任一条件返回的存储，则不会加载窗体区域:</span><span class="sxs-lookup"><span data-stu-id="6fb67-p117">The add-in must check for the return value of <b>GetFormRegionStorage</b>. A form region will not load if any of the following is true of the returned storage:</span></span></para>
          <list type="bullet">
            <item>
              <para><span data-ttu-id="6fb67-166">返回的存储是用非区域设置路径指定的 .OFS 文件。</span><span class="sxs-lookup"><span data-stu-id="6fb67-166">The returned storage is a .OFS file specified with a non-local path.</span></span></para>
            </item>
            <item>
              <para><span data-ttu-id="6fb67-167">返回的存储是一个文件，但不是从窗体设计器保存的 .OFS 文件。</span><span class="sxs-lookup"><span data-stu-id="6fb67-167">The returned storage is a file but is not an .OFS file saved from the forms designer.</span></span></para>
            </item>
          </list>
          <para><span data-ttu-id="6fb67-168">有关加载项 C# 和 Visual Basic.NET 中实现的示例<see cref="T:Microsoft.Office.Interop.Outlook.FormRegionStartup" />接口，请参阅 MSDN 上的代码示例下载。</span><span class="sxs-lookup"><span data-stu-id="6fb67-168">For examples of add-ins in C# and  Visual Basic .NET that implement the <see cref="T:Microsoft.Office.Interop.Outlook.FormRegionStartup" /> interface, see code sample downloads on MSDN.</span></span></para>
          <para> </para></remarks>
      </Docs>
    </Member>
  </Members>
</Type>
